(window.webpackJsonp=window.webpackJsonp||[]).push([["npm.docxtemplater"],{"037e":function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(o.key),o)}}var i=r("3c86"),a=r("5558").isContent,s=r("c838"),l=s.throwRawTagShouldBeOnlyTextInParagraph,u=s.getInvalidRawXMLValueException,c="rawxml",p=r("50a1");function f(e){var t=e.part,r=e.left,n=e.right,o=e.postparsed,i=e.index,s=o.slice(r+1,n);return s.forEach((function(e,n){n!==i-r-1&&a(e)&&l({paragraphParts:s,part:t})})),t}var h=function(){return e=function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.name="RawXmlModule",this.prefix="@"},(t=[{key:"optionsTransformer",value:function(e,t){return this.fileTypeConfig=t.fileTypeConfig,e}},{key:"matchers",value:function(){return[[this.prefix,c]]}},{key:"postparse",value:function(e){return i.expandToOne(e,{moduleName:c,getInner:f,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(e){return'The tag "'.concat(e.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(e,t){if(e.module!==c)return null;var r,n=[];try{null==(r=t.scopeManager.getValue(e.value,{part:e}))&&(r=t.nullGetter(e))}catch(e){return n.push(e),{errors:n}}return"string"==typeof(r=r||"")?{value:r}:{errors:[u({tag:e.value,value:r,offset:e.offset})]}}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return p(new h)}},"0cd2":function(e,t,r){var n=r("c838"),o=n.throwUnimplementedTagType,i=n.XTScopeParserError,a=r("f9a2");e.exports=function(e){var t=e.baseNullGetter,r=e.compiled,n=e.scopeManager,s=(e.nullGetter=function(e,r){return t(e,r||n)},[]);r=r.map((function(t,r){var n;e.index=r,e.resolvedId=a(t,e);try{n=function(e,t){for(var r,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].render(e,t))return r;return!1}(t,e)}catch(r){if(r instanceof i)return s.push(r),t;throw r}return n?(n.errors&&Array.prototype.push.apply(s,n.errors),n):"content"===t.type||"tag"===t.type?t:void o(t,r)})).reduce((function(e,t){var r=t.value;if(r instanceof Array)for(var n=0,o=r.length;n<o;n++)e.push(r[n]);else r&&e.push(r);return e}),[]);return{errors:s,parts:r}}},"0dc8":function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(o.key),o)}}var i=r("c838").getScopeParserExecutionError,a=r("b227").last,s=r("5558").concatArrays;function l(e,t){for(var r,n=e.length>>>0,o=0;o<n;o++)if(r=e[o],t.call(this,r,o,e))return r}function u(e,t,r){var n,o,a=this,s=this.scopeList[r];if(this.root.finishedResolving){for(var c=this.resolved,p=this.resolveOffset,f=this.scopePath.length;p<f;p++)!function(){var e=a.scopeLindex[p];c=(c=l(c,(function(t){return t.lIndex===e}))).value[a.scopePathItem[p]]}();return l(c,(function(e){return t.part.lIndex===e.lIndex})).value}o=this.cachedParsers&&t.part?this.cachedParsers[t.part.lIndex]||(this.cachedParsers[t.part.lIndex]=this.parser(e,{tag:t.part,scopePath:this.scopePath})):this.parser(e,{tag:t.part,scopePath:this.scopePath});try{n=o.get(s,this.getContext(t,r))}catch(r){throw i({tag:e,scope:s,error:r,offset:t.part.offset})}return null==n&&0<r?u.call(this,e,t,r-1):n}function c(e,t,r){var n=this,o=this.scopeList[r],a=this.cachedParsers&&t.part?this.cachedParsers[t.part.lIndex]||(this.cachedParsers[t.part.lIndex]=this.parser(e,{tag:t.part,scopePath:this.scopePath})):this.parser(e,{tag:t.part,scopePath:this.scopePath});return Promise.resolve().then((function(){return a.get(o,n.getContext(t,r))})).catch((function(r){throw i({tag:e,scope:o,error:r,offset:t.part.offset})})).then((function(o){return null==o&&0<r?c.call(n,e,t,r-1):o}))}var p=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.root=t.root||this,this.resolveOffset=t.resolveOffset||0,this.scopePath=t.scopePath,this.scopePathItem=t.scopePathItem,this.scopePathLength=t.scopePathLength,this.scopeList=t.scopeList,this.scopeType="",this.scopeTypes=t.scopeTypes,this.scopeLindex=t.scopeLindex,this.parser=t.parser,this.resolved=t.resolved,this.cachedParsers=t.cachedParsers}return t=e,(r=[{key:"loopOver",value:function(e,t,r,n){return this.loopOverValue(this.getValue(e,n),t,r)}},{key:"functorIfInverted",value:function(e,t,r,n,o){return e&&t(r,n,o),e}},{key:"isValueFalsy",value:function(e,t){return null==e||!e||"[object Array]"===t&&0===e.length}},{key:"loopOverValue",value:function(e,t,r){this.root.finishedResolving&&(r=!1);var n=Object.prototype.toString.call(e);if(this.isValueFalsy(e,n))return this.scopeType=!1,this.functorIfInverted(r,t,a(this.scopeList),0,1);if("[object Array]"!==n)return"[object Object]"===n?(this.scopeType="object",this.functorIfInverted(!r,t,e,0,1)):this.functorIfInverted(!r,t,a(this.scopeList),0,1);this.scopeType="array";for(var o=0;o<e.length;o++)this.functorIfInverted(!r,t,e[o],o,e.length);return!0}},{key:"getValue",value:function(e,t){return"function"==typeof(e=u.call(this,e,t,this.scopeList.length-1))?e(this.scopeList[this.scopeList.length-1],this):e}},{key:"getValueAsync",value:function(e,t){var r=this;return c.call(this,e,t,this.scopeList.length-1).then((function(e){return"function"==typeof e?e(r.scopeList[r.scopeList.length-1],r):e}))}},{key:"getContext",value:function(e,t){return{num:t,meta:e,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopeTypes:this.scopeTypes,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(t,r,n,o,i){return new e({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeTypes:s([this.scopeTypes,[this.scopeType]]),scopeList:s([this.scopeList,[t]]),scopePath:s([this.scopePath,[r]]),scopePathItem:s([this.scopePathItem,[n]]),scopePathLength:s([this.scopePathLength,[i]]),scopeLindex:s([this.scopeLindex,[o.lIndex]])})}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();e.exports=function(e){return e.scopePath=[],e.scopePathItem=[],e.scopePathLength=[],e.scopeTypes=[],e.scopeLindex=[],e.scopeList=[e.tags],new p(e)}},"24f4":function(e,t,r){e.exports={settingsContentType:"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",coreContentType:"application/vnd.openxmlformats-package.core-properties+xml",appContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml",customContentType:"application/vnd.openxmlformats-officedocument.custom-properties+xml"}},2522:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(o.key),o)}}var i=r("50a1"),a=(r=r("5558")).isTextStart,s=r.isTextEnd,l=r.endsWith,u=r.startsWith,c='<w:t xml:space="preserve">',p=c.length,f="</w:t>".length;function h(e,t){var r=e[t].value;return"</w:t>"===e[t+1].value||-1!==r.indexOf('xml:space="preserve"')?r:r.substr(0,r.length-1)+' xml:space="preserve">'}var d=function(){return e=function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.name="SpacePreserveModule"},(t=[{key:"postparse",value:function(e,t){var r=[],n=!1,o=0,i=0;return e=e.reduce((function(e,l){var u,c;return a(u=l)&&"w:t"===u.tag&&(n=!0,i=r.length),n?(r.push(l),u=r,(c=t)&&c.basePart&&1<u.length&&(o=t.basePart.endLindex,r[0].value=h(r,0)),c=r,"placeholder"===l.type&&1<c.length&&(r[i].value=h(r,i),o=l.endLindex),s(l)&&l.lIndex>o&&(0!==o&&(r[i].value=h(r,i)),Array.prototype.push.apply(e,r),n=!(r=[]),i=o=0)):e.push(l),e}),[]),Array.prototype.push.apply(e,r),e}},{key:"postrender",value:function(e){for(var t="",r=0,n=0,o=e.length;n<o;n++){var i=n,a=e[n];""!==a&&(l(t,c)&&u(a,"</w:t>")&&(e[r]=t.substr(0,t.length-p)+"<w:t/>",a=a.substr(f)),t=a,r=i,e[n]=a)}return e}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return i(new d)}},3101:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?i(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){var o,i;o=e,i=r[t=t],(t=function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(t))in o?Object.defineProperty(o,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[t]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=r("f9a2");e.exports=function(e){var t=[],r=e.baseNullGetter,n=e.compiled,i=e.scopeManager,a=(e.nullGetter=function(e,t){return r(e,t||i)},e.resolved=t,[]);return Promise.all(n.filter((function(e){return-1===["content","tag"].indexOf(e.type)})).reduce((function(r,n){var u,c=function(e,t){for(var r,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].resolve(e,t))return r;return!1}(n,s(s({},e),{},{resolvedId:l(n,e)}));if(c)u=c.then((function(e){t.push({tag:n.value,lIndex:n.lIndex,value:e})}));else{if("placeholder"!==n.type)return;u=i.getValueAsync(n.value,{part:n}).then((function(t){return null==t?e.nullGetter(n):t})).then((function(e){return t.push({tag:n.value,lIndex:n.lIndex,value:e}),e}))}return r.push(u.catch((function(e){e instanceof Array?a.push.apply(a,o(e)):a.push(e)}))),r}),[])).then((function(){return{errors:a,resolved:t}}))}},"3a82":function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){var o,i;o=e,i=r[t=t],(t=function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(t))in o?Object.defineProperty(o,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[t]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){var r;if(e)return"string"==typeof e?u(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var c=r("5558").wordToUtf8,p=(r=r("b765")).match,f=r.getValue,h=r.getValues;e.exports={preparse:function(e,t,r){return{preparsed:function(e,r){return t.forEach((function(t){t.preparse(e,r)}))}(e,r)}},parse:function(e,t,r){var n,o=!1,l="",u=[],d=r.fileTypeConfig.droppedTagsInsidePlaceholder||[];return e.reduce((function(e,y){return"delimiter"===y.type?(o="start"===y.position,"end"===y.position&&(r.parse=function(e){return function(e,t){var r=t.modules,n=t.startOffset,o=t.lIndex;t.offset=n,t.match=p,t.getValue=f,t.getValues=h;var l,u=function(e,t,r){for(var n=[],o=0,s=e.length;o<s;o++){var l,u=(c=a(p=e[o],2))[0],c=c[1],p=p[2]||{};r.match(u,t)&&(l=r.getValues(u,t),(p="function"==typeof p?p(l):p).value||(l=a(l,2),p.value=l[1]),n.push(i({type:"placeholder",prefix:u,module:c,onMatch:p.onMatch,priority:p.priority},p)))}return n}(function(e,t){for(var r=[],n=0,o=e.length;n<o;n++){var i=e[n];if(i.matchers){if(!((i=i.matchers(t))instanceof Array))throw new Error("module matcher returns a non array");r.push.apply(r,s(i))}}return r}(r,t),e,t);if(0<u.length)return l=null,u.forEach((function(e){e.priority=e.priority||-e.value.length,(!l||e.priority>l.priority)&&(l=e)})),l.offset=n,delete l.priority,l.endLindex=o,l.lIndex=o,l.raw=e,l.onMatch&&l.onMatch(l),delete l.onMatch,delete l.prefix,l;for(var c,d=0,y=r.length;d<y;d++)if(c=r[d].parse(e,t))return c.offset=n,c.endLindex=o,c.lIndex=o,c.raw=e,c;return{type:"placeholder",value:e,offset:n,endLindex:o,lIndex:o}}(e,i(i(i({},r),y),{},{startOffset:n,modules:t}))},e.push(r.parse(c(l))),Array.prototype.push.apply(e,u),u=[]),"start"===y.position&&(u=[],n=y.offset),l=""):o?"content"!==y.type||"insidetag"!==y.position?-1===d.indexOf(y.tag)&&u.push(y):l+=y.value:e.push(y),e}),[])},postparse:function(e,t,r){function n(e,r){return t.map((function(t){return t.getTraits(e,r)}))}var o=[];return{postparsed:function e(r,a){return t.reduce((function(t,r){return null==(r=r.postparse(t,i(i({},a),{},{postparse:function(t,r){return e(t,i(i({},a),r))},getTraits:n})))?t:r.errors?(Array.prototype.push.apply(o,r.errors),r.postparsed):r}),r)}(e,r),errors:o}}}},"3be1":function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(o.key),o)}}var i,a=r("f418"),s=(i=r("5558")).getLeft,l=i.getRight,u=r("50a1"),c=r("3c86").getExpandToDefault,p=(i=r("c838")).getUnmatchedLoopException,f=i.getClosingTagNotMatchOpeningTag,h=i.getUnbalancedLoopException;function d(e,t){return null!=e&&null!=t&&("start"===e.part.location&&"end"===t.part.location&&e.part.value===t.part.value||""===t.part.value)}function y(e){for(var t={},r=[],n=[],o=[],i=0;i<e.length;i++)o.push(e[i]);for(;0<o.length;){var a=function(e){for(var t=0,r=[];t<e.length;){var n=e[t].part;if("end"===n.location){if(0===t)e.splice(0,1),r.push(p(n));else{var o=t,i=t-1,a=1;if(d(e[i],e[o]))return e.splice(o,1),e.splice(i,1),{errors:r,traits:e};for(;a<50;){var s=e[i-a],l=e[o+a];if(d(s,e[o]))return e.splice(o,1),e.splice(i-a,1),{errors:r,traits:e};if(d(e[i],l))return e.splice(o+a,1),e.splice(i,1),{errors:r,traits:e};a++}r.push(f({tags:[e[i].part,e[o].part]})),e.splice(o,1),e.splice(i,1)}return{traits:e,errors:r}}t++}return e.forEach((function(e){e=e.part,r.push(p(e))})),{traits:[],errors:r}}(o);r=r.concat(a.errors),o=a.traits}if(!(0<r.length))for(var s=0,l=0;l<e.length;l++){var u=e[l],c=function(e){switch(e.location){case"start":return 1;case"end":return-1}}(u.part);s+=c,1===c?t[s]=u:0===s&&(n=n.concat([[t[s+1],u]])),s=0<=s?s:0}return{pairs:n,errors:r}}var m=function(){return e=function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.name="ExpandPairTrait"},(t=[{key:"optionsTransformer",value:function(e,t){return this.expandTags=t.fileTypeConfig.expandTags.concat(t.options.paragraphLoop?t.fileTypeConfig.onParagraphLoop:[]),e}},{key:"postparse",value:function(e,t){var r,n,o=this,i=t.getTraits,u=t.postparse,p=t.fileType,f=(t=(t=i("expandPair",e)).map((function(e){return e||[]})),(i=y(t=a(t))).pairs),d=i.errors,m=0,g=null,v=f.map((function(t){var r,n,i,a,u=t[0].part.expandTo;if("auto"===u&&"text"!==p&&((r=c(e,t,o.expandTags)).error&&d.push(r.error),u=r.value),!u||"text"===p)return r=t[0].offset,n=t[1].offset,r<m&&d.push(h(t,g)),g=t,[r,m=n];try{i=s(e,u,t[0].offset)}catch(t){d.push(t)}try{a=l(e,u,t[1].offset)}catch(t){d.push(t)}return i<m&&d.push(h(t,g)),g=t,[i,m=a]}));return 0<d.length?{postparsed:e,errors:d}:(r=0,{postparsed:e.reduce((function(t,o,i){var a=r<f.length&&v[r][0]<=i&&i<=v[r][1],s=f[r],l=v[r];return a?(l[0]===i&&(n=[]),s[0].offset!==i&&s[1].offset!==i&&n.push(o),l[1]===i&&((a=e[s[0].offset]).subparsed=u(n,{basePart:a}),a.endLindex=s[1].part.lIndex,delete a.location,delete a.expandTo,t.push(a),r++)):t.push(o),t}),[]),errors:d})}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return u(new m)}},"3c86":function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var r;if(e)return"string"==typeof e?s(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){var o,i;o=e,i=r[t=t],(t=function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(t))in o?Object.defineProperty(o,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[t]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c,p=(c=r("5558")).getRightOrNull,f=c.getRight,h=c.getLeft,d=c.getLeftOrNull,y=c.chunkBy,m=c.isTagStart,g=c.isTagEnd,v=c.isContent,b=c.last,w=c.first,x=(c=r("c838")).XTTemplateError,T=c.throwExpandNotFound,P=c.getLoopPositionProducesInvalidXMLError;e.exports={expandToOne:function(e,t){for(var r=[],n=(e.errors&&(r=e.errors,e=e.postparsed),[]),a=0,s=e.length;a<s;a++){var l=e[a];if("placeholder"===l.type&&l.module===t.moduleName&&!l.subparsed&&!l.expanded)try{var c,p,d,y=function(e,t,r,n){var o,i,a=e.expandTo||n.expandTo;if(a){try{i=h(r,a,t),o=f(r,a,t)}catch(o){throw o instanceof x&&T(u({part:e,rootError:o,postparsed:r,expandTo:a,index:t},n.error)),o}return[i,o]}}(l,a,e,t);y&&(p=(c=i(y,2))[0],d=c[1],n.push({left:p,right:d,part:l,i:a,leftPart:e[p],rightPart:e[d]}))}catch(a){if(!(a instanceof x))throw a;r.push(a)}}n.sort((function(e,t){return e.left===t.left?t.part.lIndex<e.part.lIndex?1:-1:t.left<e.left?1:-1}));var m=-1,g=0;return n.forEach((function(a,s){var l,u,c,p,f,h,d,y,v;if(m=Math.max(m,0<s?n[s-1].right:0),!(a.left<m)){try{u=[a.left+g,a.right+g],c=a.part,p=e,f=t,h=(u=i(u,2))[0],u=u[1],d=p.indexOf(c),y=p.slice(h,d),v=p.slice(d+1,u+1),(f=f.getInner({postparse:f.postparse,index:d,part:c,leftParts:y,rightParts:v,left:h,right:u,postparsed:p})).length||(f.expanded=[y,v],f=[f]),l={left:h,right:u,inner:f}}catch(a){if(!(a instanceof x))throw a;r.push(a)}l&&(g+=l.inner.length-(l.right+1-l.left),e.splice.apply(e,[l.left,l.right+1-l.left].concat(o(l.inner))))}})),{postparsed:e,errors:r}},getExpandToDefault:function(e,t,r){var n=function(e){for(var t,r=[],n=0;n<e.length;n++){var o,i=(o=e[n]).position,a=o.value;(o=o.tag)&&("end"===i?(o=o,0!==(t=r).length&&0===b(t).substr(1).indexOf(o)?r.pop():r.push(a)):"start"===i&&r.push(a))}return r}(e.slice(t[0].offset,t[1].offset));if(n.filter((function(e){return"/"===e[1]})).length!==n.filter((function(e){return"/"!==e[1]&&"/"!==e[e.length-2]})).length)return{error:P({tag:w(t).part.value,offset:[w(t).part.offset,b(t).part.offset]})};for(var o,i=function(){var o=(s=r[a]).contains,i=s.expand,s=s.onlyTextInTag;if(function(e,t){for(var r=0;r<t.length;r++)if(0===t[r].indexOf("<".concat(e)))return 1}(o,n)){if(s){s=d(e,o,t[0].offset);var l=p(e,o,t[1].offset);if(null===s||null===l)return 0;if(s=y(e.slice(s,l),(function(e){return m(o,e)?"start":g(o,e)?"end":null})),l=w(s),s=b(s),l=l.filter(v),s=s.filter(v),1!==l.length||1!==s.length)return 0}return{v:{value:i}}}},a=0,s=r.length;a<s;a++)if(0!==(o=i())&&o)return o.v;return{}}}},4072:function(e,t,r){var n=r("5558").pregMatchAll;e.exports=function(e,t){return e={content:e},t=t.join("|"),t=new RegExp("(?:(<(?:".concat(t,")[^>]*>)([^<>]*)</(?:").concat(t,")>)|(<(?:").concat(t,")[^>]*/>)"),"g"),e.matches=n(t,e.content),e}},"50a1":function(e,t,r){var n=r("c838").XTInternalError;function o(){}function i(e){return e}e.exports=function(e){var t,r={set:o,matchers:function(){return[]},parse:o,render:o,getTraits:o,getFileType:o,nullGetter:o,optionsTransformer:i,postrender:i,errorsTransformer:i,getRenderedMap:i,preparse:i,postparse:i,on:o,resolve:o,preResolve:o};if(Object.keys(r).every((function(t){return!e[t]})))throw(t=new n("This module cannot be wrapped, because it doesn't define any of the necessary functions")).properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"},t;return Object.keys(r).forEach((function(t){e[t]=e[t]||r[t]})),e}},5114:function(e,t,r){var n=r("c113"),o=r("2522"),i=r("037e"),a=r("3be1"),s=r("a6b4");e.exports={docx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(e){return e.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","cp:contentStatus","w:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:tbl","w:body","w:document","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sdt","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference","w:bookmarkStart","w:bookmarkEnd","w:commentRangeStart","w:commentRangeEnd","w:commentReference"],droppedTagsInsidePlaceholder:["w:p","w:br","w:bookmarkStart","w:bookmarkEnd"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",baseModules:[n,o,a,i,s],tagShouldContain:[{tag:"w:tbl",shouldContain:["w:tr"],drop:!0},{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:sdtContent",shouldContain:["w:p","w:r","w:commentRangeStart","w:sdt"],value:"<w:p></w:p>"}]}},pptx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(e){return e.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:tbl","a:graphicData","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId","a:endParaRPr"],droppedTagsInsidePlaceholder:["a:p","a:endParaRPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",baseModules:[n,a,i,s],tagShouldContain:[{tag:"a:tbl",shouldContain:["a:tr"],dropParent:"p:graphicFrame"},{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}}},5558:function(e,t,r){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o,i=(o=r("210b")).DOMParser,a=o.XMLSerializer,s=r("c838").throwXmlTagNotFound,l=(o=r("b227")).last,u=(r=o.first,{});o={errorLogging:"json",paragraphLoop:!1,nullGetter:function(e){return e.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:function(e){return{get:function(t){return"."===e?t:t&&t[e]}}},linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"},syntax:{}};var c=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]],p=c.map((function(e){var t=(e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2))[0];e=e[1];return{rstart:new RegExp(e,"g"),rend:new RegExp(t,"g"),start:e,end:t}})),f=new RegExp(String.fromCharCode(160),"g");function h(e,t){return e==="</"+t+">"}function d(e,t){return 0===e.indexOf("<"+t)&&-1!==[">"," ","/"].indexOf(e[t.length+1])}function y(e,t,r){"string"==typeof t&&(t=[t]);for(var n=1,o=r,i=e.length;o<i;o++)for(var a=e[o],s=0,l=t.length;s<l;s++){var u=t[s];if(h(a.value,u)&&n--,d(a.value,u)&&n++,0===n)return o}return null}function m(e,t,r){"string"==typeof t&&(t=[t]);for(var n=1,o=r;0<=o;o--)for(var i=e[o],a=0,s=t.length;a<s;a++){var l=t[a];if(d(i.value,l)&&n--,h(i.value,l)&&n++,0===n)return o}return null}function g(e,t){var r=t.type,n=t.tag;t=t.position;return"tag"===r&&n===e&&"start"===t}function v(e,t){var r=t.type,n=t.tag;t=t.position;return"tag"===r&&n===e&&"end"===t}var b=/[\x00-\x08\x0B\x0C\x0E-\x1F]/;e.exports={endsWith:function(e,t){return-1!==e.indexOf(t,e.length-t.length)},startsWith:function(e,t){return e.substring(0,t.length)===t},isContent:function(e){var t=e.type;e=e.position;return"placeholder"===t||"content"===t&&"insidetag"===e},isParagraphStart:function(e){return g("w:p",e)||g("a:p",e)},isParagraphEnd:function(e){return v("w:p",e)||v("a:p",e)},isTagStart:function(e,t){var r=t.type,n=t.tag;t=t.position;return"tag"===r&&n===e&&("start"===t||"selfclosing"===t)},isTagEnd:v,isTextStart:function(e){var t=e.type,r=e.position;e=e.text;return"tag"===t&&"start"===r&&e},isTextEnd:function(e){var t=e.type,r=e.position;e=e.text;return"tag"===t&&"end"===r&&e},isStarting:d,isEnding:h,isModule:function(e,t){var r=e.module;e=e.type;return t instanceof Array||(t=[t]),"placeholder"===e&&-1!==t.indexOf(r)},uniq:function(e){for(var t={},r=[],n=0,o=e.length;n<o;++n)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r},getDuplicates:function(e){for(var t=[],r={},n=[],o=0,i=e.length;o<i;++o)(r[e[o]]?t:(r[e[o]]=!0,n)).push(e[o]);return t},chunkBy:function(e,t){return e.reduce((function(e,r){var n=l(e),o=t(r);return"start"===o?e.push([r]):"end"===o?(n.push(r),e.push([])):n.push(r),e}),[[]]).filter((function(e){return 0<e.length}))},last:l,first:r,xml2str:function(e){return(new a).serializeToString(e).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function(e){return 65279===e.charCodeAt(0)&&(e=e.substr(1)),(new i).parseFromString(e,"text/xml")},getRightOrNull:y,getRight:function(e,t,r){var n=y(e,t,r);if(null!==n)return n;s({position:"right",element:t,parsed:e,index:r})},getLeftOrNull:m,getLeft:function(e,t,r){var n=m(e,t,r);if(null!==n)return n;s({position:"left",element:t,parsed:e,index:r})},pregMatchAll:function(e,t){for(var r,n=[];null!=(r=e.exec(t));)n.push({array:r,offset:r.index});return n},convertSpaces:function(e){return e.replace(f," ")},charMapRegexes:p,hasCorruptCharacters:function(e){return b.test(e)},defaults:o,wordToUtf8:function(e){for(var t,r=p.length-1;0<=r;r--)t=p[r],e=e.replace(t.rstart,t.end);return e},utf8ToWord:function(e){var t;e=e.toString();for(var r=0,n=p.length;r<n;r++)t=p[r],e=e.replace(t.rend,t.start);return e},concatArrays:function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],o=0,i=n.length;o<i;o++)t.push(n[o]);return t},invertMap:function(e){return Object.keys(e).reduce((function(t,r){var n=e[r];return t[n]=t[n]||[],t[n].push(r),t}),{})},charMap:c,getSingleAttribute:function(e,t){var r;return-1===(t=e.indexOf(" ".concat(t,'="')))?null:(t=e.substr(t).search(/["']/)+t,r=e.substr(t+1).search(/["']/)+t,e.substr(t+1,r-t))},setSingleAttribute:function(e,t,r){var n;return u[t]?n=u[t]:(n=new RegExp("(<.* ".concat(t,'=")([^"]*)(".*)$')),u[t]=n),n.test(e)?e.replace(n,"$1".concat(r,"$3")):(-1===(n=e.lastIndexOf("/>"))&&(n=e.lastIndexOf(">")),e.substr(0,n)+" ".concat(t,'="').concat(r,'"')+e.substr(n))},isWhiteSpace:function(e){return/^[ \n\r\t]+$/.test(e)},stableSort:function(e,t){return e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item}))}}},"84db":function(e,t,r){function n(e){for(var t,r,n=0,o=e.length,i=0;i<o;i++)55296==(64512&(t=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(r=e.charCodeAt(i+1)))&&(t=65536+(t-55296<<10)+(r-56320),i++),n+=t<128?1:t<2048?2:t<65536?3:4;var a=new Uint8Array(n),s=0;for(i=0;s<n;i++)55296==(64512&(t=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(r=e.charCodeAt(i+1)))&&(t=65536+(t-55296<<10)+(r-56320),i++),t<128?a[s++]=t:(t<2048?a[s++]=192|t>>>6:(t<65536?a[s++]=224|t>>>12:(a[s++]=240|t>>>18,a[s++]=128|t>>>12&63),a[s++]=128|t>>>6&63),a[s++]=128|63&t);return a}e.exports=function(e,t){for(var r=0,o=t.modules.length;r<o;r++)e=t.modules[r].postrender(e,t);for(var i=0,a=t.joinUncorrupt(e,t),s="",l=0,u=[],c=0,p=a.length;c<p;c++){var f,h=a[c];65536<h.length+l&&(i+=(f=n(s)).length,u.push(f),s=""),s+=h,l+=h.length,delete a[c]}var d=n(s),y=(i+=d.length,u.push(d),new Uint8Array(i)),m=0;return u.forEach((function(e){for(var t=0;t<e.length;++t)y[t+m]=e[t];m+=e.length})),y}},"8a20":function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(o.key),o)}}var i=r("5558"),a=i.wordToUtf8,s=i.convertSpaces,l=r("4072"),u=r("e192"),c=r("3a82"),p=r("0cd2"),f=r("84db"),h=r("3101"),d=r("a9dc");e.exports=function(){return e=function e(t,r){var n=this;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.cachedParsers={},this.content=t,Object.keys(r).forEach((function(e){n[e]=r[e]})),this.setModules({inspect:{filePath:r.filePath}})},(t=[{key:"resolveTags",value:function(e){var t=this,r=(this.tags=e,this.getOptions()),n=this.filePath,o=(r.scopeManager=this.scopeManager,r.resolve=h,[]);return Promise.all(this.modules.map((function(e){return Promise.resolve(e.preResolve(r)).catch((function(e){o.push(e)}))}))).then((function(){if(0!==o.length)throw o;return h(r).then((function(e){var o=e.resolved;if(0!==(e=(e=e.errors).map((function(e){return(e=e instanceof Error?e:new Error(e)).properties=e.properties||{},e.properties.file=n,e}))).length)throw e;return Promise.all(o).then((function(e){return r.scopeManager.root.finishedResolving=!0,r.scopeManager.resolved=e,t.setModules({inspect:{resolved:e,filePath:n}}),e}))}))}))}},{key:"getFullText",value:function(){return e=this.content,t=this.fileTypeConfig.tagsXmlTextArray,e=l(e,t).matches.map((function(e){return e.array[2]})),a(s(e.join("")));var e,t}},{key:"setModules",value:function(e){this.modules.forEach((function(t){t.set(e)}))}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=u.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{filePath:this.filePath,xmllexed:this.xmllexed}});var e=(t=u.parse(this.xmllexed,this.delimiters,this.syntax,this.fileType)).lexed,t=t.errors;this.allErrors=this.allErrors.concat(t),this.lexed=e,this.setModules({inspect:{filePath:this.filePath,lexed:this.lexed}}),t=this.getOptions();c.preparse(this.lexed,this.modules,t)}},{key:"parse",value:function(){this.setModules({inspect:{filePath:this.filePath}});var e=this.getOptions(),t=(e=(this.parsed=c.parse(this.lexed,this.modules,e),this.setModules({inspect:{filePath:this.filePath,parsed:this.parsed}}),c.postparse(this.parsed,this.modules,e))).postparsed;e=e.errors;return this.postparsed=t,this.setModules({inspect:{filePath:this.filePath,postparsed:this.postparsed}}),this.allErrors=this.allErrors.concat(e),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(e){var t=this;e.forEach((function(e){e.properties=e.properties||{},e.properties.file=t.filePath})),this.modules.forEach((function(t){e=t.errorsTransformer(e)}))}},{key:"baseNullGetter",value:function(e,t){var r=this,n=this.modules.reduce((function(n,o){return null!=n?n:o.nullGetter(e,t,r)}),null);return null!=n?n:this.nullGetter(e,t)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,relsType:this.relsType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks}}},{key:"render",value:function(e){this.filePath=e;var t=(r=((e=this.getOptions()).resolved=this.scopeManager.resolved,e.scopeManager=this.scopeManager,e.render=p,e.joinUncorrupt=d,p(e))).errors,r=r.parts;return 0<t.length?(this.allErrors=t,this.errorChecker(t)):(this.content=f(r,e),this.setModules({inspect:{filePath:this.filePath,content:this.content}})),this}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},a6b4:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(o.key),o)}}var i,a=r("50a1"),s=r("c838").getScopeCompilationError,l=(i=r("5558")).utf8ToWord,u=i.hasCorruptCharacters,c=r("c838").getCorruptCharactersException,p=(i=r("24f4")).settingsContentType,f=i.coreContentType,h=i.appContentType,d=i.customContentType,y={docx:"w",pptx:"a"},m=function(){return e=function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.name="Render",this.recordRun=!1,this.recordedRun=[]},(t=[{key:"optionsTransformer",value:function(e,t){return this.parser=t.parser,this.fileType=t.fileType,e}},{key:"set",value:function(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:"getRenderedMap",value:function(e){var t=this;return Object.keys(this.compiled).reduce((function(e,r){return e[r]={from:r,data:t.data},e}),e)}},{key:"postparse",value:function(e,t){var r=this,n=[];return e.forEach((function(e){if("placeholder"===e.type){var o=e.value;try{t.cachedParsers[e.lIndex]=r.parser(o,{tag:e})}catch(t){n.push(s({tag:o,rootError:t,offset:e.offset}))}}})),{postparsed:e,errors:n}}},{key:"render",value:function(e,t){var r,n=t.contentType,o=t.scopeManager,i=t.linebreaks,a=t.nullGetter;t=t.fileType;if((i=(!i||-1===[p,f,h,d].indexOf(n))&&i)&&this.recordRuns(e),"placeholder"===e.type&&!e.module){try{r=o.getValue(e.value,{part:e})}catch(e){return{errors:[e]}}return null==r&&(r=a(e)),u(r)?{errors:[c({tag:e.value,value:r,offset:e.offset})]}:"text"===t?{value:r}:{value:i&&"string"==typeof r?this.renderLineBreaks(r):l(r)}}}},{key:"recordRuns",value:function(e){e.tag==="".concat(y[this.fileType],":r")?this.recordedRun=[]:e.tag==="".concat(y[this.fileType],":rPr")?("start"===e.position&&(this.recordRun=!0,this.recordedRun=[e.value]),"end"!==e.position&&"selfclosing"!==e.position||(this.recordedRun.push(e.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(e.value)}},{key:"renderLineBreaks",value:function(e){var t=this,r=y[this.fileType],n="docx"===this.fileType?"<w:r><w:br/></w:r>":"<a:br/>",o=e.split("\n"),i=this.recordedRun.join("");return o.map((function(e){return l(e)})).reduce((function(e,a,s){return e.push(a),s<o.length-1&&e.push("</".concat(r,":t></").concat(r,":r>").concat(n,"<").concat(r,":r>").concat(i,"<").concat(r,":t").concat("docx"===t.fileType?' xml:space="preserve"':"",">")),e}),[])}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return a(new m)}},a9dc:function(e,t,r){var n=r("5558"),o=n.startsWith,i=n.endsWith,a=n.isStarting,s=n.isEnding,l=n.isWhiteSpace,u=r("ddee");e.exports=function(e,t){for(var r=t.fileTypeConfig.tagShouldContain||[],n="",c=-1,p=-1,f=0,h=(e=-1!==u.docx.indexOf(t.contentType)?function(e){for(var t="",r=0,n=e.length;r<n;r++){var a=e[r];l(a)||(t=a=!i(t,"</w:tbl>")||o(a,"<w:p")||o(a,"<w:tbl")||o(a,"<w:sectPr")?a:"<w:p/>".concat(a),e[r]=a)}return e}(e):e).length;f<h;f++)for(var d=e[f],y=0,m=r.length;y<m;y++){var g=r[y],v=g.tag,b=g.shouldContain,w=g.value,x=g.drop,T=g.dropParent;if(c===y){if(s(d,v)){if(c=-1,T){for(var P=void 0,O=void 0,S=p;0<S;S--)if(a(e[S],T)){P=S;break}for(var E=f;E<e.length;E++)if(s(e[E],T)){O=E;break}for(var j=P;j<=O;j++)e[j]=""}else if(x)for(var k=p;k<=f;k++)e[k]="";else{for(var C=p;C<f;C++)e[C]="";e[f]=n+w+d}break}n+=d;for(var I=0,A=b.length;I<A;I++){var M=b[I];if(a(d,M)){c=-1;break}}break}if(-1===c&&a(d,v)&&-1===d.substr(1).indexOf("<")){if("/"===d[d.length-2]){e[f]="";break}p=f,c=y,n=d;break}}return e}},b227:function(e,t,r){e.exports={last:function(e){return e[e.length-1]},first:function(e){return e[0]}}},b765:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=new RegExp(String.fromCharCode(160),"g");function i(e){return e.replace(o," ")}e.exports={match:function(e,t){var r=n(e);return"string"===r?i(t.substr(0,e.length))===e:e instanceof RegExp?e.test(i(t)):"function"===r?!!e(t):void 0},getValue:function(e,t){var r=n(e);return"string"===r?i(t).substr(e.length):e instanceof RegExp?i(t).match(e)[1]:"function"===r?e(t):void 0},getValues:function(e,t){var r=n(e);return"string"===r?[t,i(t).substr(e.length)]:e instanceof RegExp?i(t).match(e):"function"===r?[t,e(t)]:void 0}}},c113:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){var n,o;n=e,o=r[t=t],(t=c(t))in n?Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[t]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){var r;if(e)return"string"==typeof e?l(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}var p=r("5558"),f=p.chunkBy,h=p.last,d=p.isParagraphStart,y=p.isModule,m=p.isParagraphEnd,g=p.isContent,v=p.startsWith,b=p.isTagEnd,w=p.isTagStart,x=p.getSingleAttribute,T=p.setSingleAttribute,P=r("ddee"),O=r("50a1"),S="loop";function E(e){return null!=(e=function(e){for(var t=0,r=e.length;t<r;t++)if("content"!==e[t].type)return e[t];return null}(e.subparsed))&&"w:t"!==e.tag}function j(e){return e.some((function(e){return g(e)}))?0:e.length}function k(e){var t=e.parts.length-1;"</w:p>"===e.parts[t]?e.parts.splice(t,0,'<w:r><w:br w:type="page"/></w:r>'):e.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function C(e){return e.some((function(e){return"w:br"===e.tag&&-1!==e.value.indexOf('w:type="page"')}))}function I(e){return e.some((function(e){return"w:drawing"===e.tag}))}var A=function(){return e=function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.name="LoopModule",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}},(t=[{key:"optionsTransformer",value:function(e,t){return this.docxtemplater=t,e}},{key:"preparse",value:function(e,t){var r,n;t=t.contentType;-1!==P.main.indexOf(t)&&(this.sects=(r=!1,n=[],e.forEach((function(e){w("w:sectPr",e)&&(n.push([]),r=!0),r&&n[n.length-1].push(e),b("w:sectPr",e)&&(r=!1)})),n))}},{key:"matchers",value:function(){return[[this.prefix.start,S,{expandTo:"auto",location:"start",inverted:!1}],[this.prefix.inverted,S,{expandTo:"auto",location:"start",inverted:!0}],[this.prefix.end,S,{location:"end"}],[this.prefix.dash,S,function(e){return{location:"start",inverted:!1,expandTo:(e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,3))[1],value:e[2]}}]]}},{key:"getTraits",value:function(e,t){if("expandPair"===e)return t.reduce((function(e,t,r){return y(t,S)&&null==t.subparsed&&e.push({part:t,offset:r}),e}),[])}},{key:"postparse",value:function(e,t){var r,n,o,i=t.basePart;if(i&&"docx"===this.docxtemplater.fileType&&0<e.length&&(i.sectPrCount=(n=!1,o=0,e.forEach((function(e){!(n=!!w("w:sectPr",e)||n)||"w:headerReference"!==e.tag&&"w:footerReference"!==e.tag||(o++,n=!1),b("w:sectPr",e)&&(n=!1)})),o),this.totalSectPr+=i.sectPrCount,(r=this.sects).some((function(t,n){return i.lIndex<t[0].lIndex?(n+1<r.length&&r[n+1].some((function(e){return w("w:type",e)&&-1!==e.value.indexOf("continuous")}))&&(i.addContinuousType=!0),!0):e[0].lIndex<t[0].lIndex&&t[0].lIndex<i.lIndex?(r[n].some((function(e){return w("w:type",e)&&-1!==e.value.indexOf('w:val="nextPage"')}))&&(i.addNextPage={index:n}),!0):void 0})),i.lastParagrapSectPr=function(e){for(var t=[],r=!1,n=e.length-1;0<=n;n--){var o=e[n];if(b("w:sectPr",o)&&(r=!0),w("w:sectPr",o)&&(t.unshift(o.value),r=!1),r&&t.unshift(o.value),d(o)){if(0<t.length)return t.join("");break}}return""}(e)),!(i&&"auto"===i.expandTo&&i.module===S&&(t=e).length&&d(t[0])&&m(h(t))))return e;i.paragraphLoop=!0;var a=0,s=(t=f(e,(function(e){return d(e)&&1==++a?"start":m(e)&&0==--a?"end":null})))[0],l=(t=h(t),j(s)),u=j(t);return i.hasPageBreakBeginning=C(s),i.hasPageBreak=C(t),I(s)&&(l=0),I(t)&&(u=0),e.slice(l,e.length-u)}},{key:"resolve",value:function(e,t){var r,n,i,s;return y(e,S)?(n=(r=t.scopeManager).getValueAsync(e.value,{part:e}),i=[],s=[],n.then((function(t){return new Promise((function(e){t instanceof Array?Promise.all(t).then(e):e(t)})).then((function(t){return r.loopOverValue(t,l,e.inverted),Promise.all(i).then((function(e){return e.map((function(e){var t=e.resolved;e=e.errors;return s.push.apply(s,o(e)),t}))})).then((function(e){if(0<s.length)throw s;return e}))}))}))):null;function l(n,o,s){n=r.createSubScopeManager(n,e.value,o,e,s),i.push(t.resolve(a(a({},t),{},{compiled:e.subparsed,tags:{},scopeManager:n})))}}},{key:"render",value:function(e,t){var r,n,o,i,s,l,u,c;return"p:xfrm"===e.tag&&(this.inXfrm="start"===e.position),"a:ext"===e.tag&&this.inXfrm?this.lastExt=e:y(e,S)?(r=[],n=[],o=0,i=this,c=e.subparsed[0],s=0,"a:tr"===(null==c?void 0:c.tag)&&(s=+x(c.value,"h")),o-=s,l=0,u=E(e),!1===t.scopeManager.loopOver(e.value,(function(c,p,f){o+=s;c=t.scopeManager.createSubScopeManager(c,e.value,p,e,f);var h,d,y=(e.subparsed.forEach((function(e){var t;w("a16:rowId",e)&&(t=+x(e.value,"val")+l,l=1,e.value=T(e.value,"val",t))})),t.render(a(a({},t),{},{compiled:e.subparsed,tags:{},scopeManager:c})));e.hasPageBreak&&p===f-1&&u&&k(y),c.scopePathItem.some((function(e){return 0!==e}))?(1===e.sectPrCount&&(y.parts=y.parts.filter((function(e){return!v(e,"<w:headerReference")&&!v(e,"<w:footerReference")}))),e.addContinuousType&&(y.parts=(p=y.parts,d=h=!1,p.reduce((function(e,t){return(d=!(!1!==h||!v(t,"<w:sectPr"))||d)&&!1===(h=!!v(t,"<w:type")||h)&&v(t,"</w:sectPr")&&e.push('<w:type w:val="continuous"/>'),e.push(t),e}),[])))):e.addNextPage&&(y.parts=(f=y.parts,c=i.sects[e.addNextPage.index],["<w:p><w:pPr>".concat(c.map((function(e){return e.value})).join(""),"</w:pPr></w:p>")].concat(f))),e.addNextPage&&k(y),e.hasPageBreakBeginning&&u&&y.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>');for(var m=0,g=y.parts.length;m<g;m++)r.push(y.parts[m]);Array.prototype.push.apply(n,y.errors)}),e.inverted,{part:e})?e.lastParagrapSectPr?e.paragraphLoop?{value:"<w:p><w:pPr>".concat(e.lastParagrapSectPr,"</w:pPr></w:p>")}:{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(e.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}:{value:((c=e).hasPageBreak&&E(c)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':"")||"",errors:n}:(0!==o&&(c=+x(this.lastExt.value,"cy"),this.lastExt.value=T(this.lastExt.value,"cy",c+o)),{value:t.joinUncorrupt(r,a(a({},t),{},{basePart:e})),errors:n})):null}}])&&u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return O(new A)}},c816:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(o.key),o)}}var i=r("50a1"),a=r("ddee"),s=[(r=r("24f4")).settingsContentType,r.coreContentType,r.appContentType,r.customContentType],l=function(){return e=function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.name="Common"},(t=[{key:"getFileType",value:function(e){var t=e.doc,r=t.invertedContentTypes;if(r){for(var n=0,o=s.length;n<o;n++){var i=s[n];r[i]&&Array.prototype.push.apply(t.targets,r[i])}for(var l,u=["docx","pptx"],c=0,p=u.length;c<p;c++){for(var f=a[u[c]],h=0,d=f.length;h<d;h++){var y=f[h];if(r[y])for(var m=0,g=r[y].length;m<g;m++){var v=r[y][m];t.relsTypes[v]&&-1===["http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"].indexOf(t.relsTypes[v])||(l=u[c],-1===a.main.indexOf(y)&&y!==a.pptx[0]||t.textTarget||(t.textTarget=v),t.targets.push(v))}}if(l)return l}return l}}}])&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=function(){return i(new l)}},c838:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}var i=(r=r("b227")).last,a=r.first;function s(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}function l(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}function u(e){this.name="RenderingError",this.message=e,this.stack=new Error(e).stack}function c(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}function p(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}function f(e){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=e,this.stack=new Error(e).stack}s.prototype=Error.prototype,l.prototype=new s,u.prototype=new s,c.prototype=new s,p.prototype=new s,f.prototype=new s,e.exports={XTError:s,XTTemplateError:l,XTInternalError:p,XTScopeParserError:c,XTAPIVersionError:f,RenderingError:u,XTRenderingError:u,getClosingTagNotMatchOpeningTag:function(e){e=e.tags;var t=new l("Closing tag does not match opening tag");return t.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(e[0].value,'" is closed by the tag "').concat(e[1].value,'"'),openingtag:a(e).value,offset:[a(e).offset,i(e).offset],closingtag:i(e).value},t},getLoopPositionProducesInvalidXMLError:function(e){var t=e.tag,r=(e=e.offset,new l('The position of the loop tags "'.concat(t,'" would produce invalid XML')));return r.properties={xtag:t,id:"loop_position_invalid",explanation:'The tags "'.concat(t,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:e},r},getScopeCompilationError:function(e){var t=e.tag,r=e.rootError,n=(e=e.offset,new c("Scope parser compilation failed"));return n.properties={id:"scopeparser_compilation_failed",offset:e,xtag:t,explanation:'The scope parser for the tag "'.concat(t,'" failed to compile'),rootError:r},n},getScopeParserExecutionError:function(e){var t=e.tag,r=e.scope,n=e.error,o=(e=e.offset,new c("Scope parser execution failed"));return o.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(t," failed to execute"),scope:r,offset:e,xtag:t,rootError:n},o},getUnclosedTagException:function(e){var t=new l("Unclosed tag");return t.properties={xtag:a(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unclosed')},t},getUnopenedTagException:function(e){var t=new l("Unopened tag");return t.properties={xtag:i(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unopened')},t},getUnmatchedLoopException:function(e){var t=e.location,r=e.offset,n=e.square,o="start"===t?"unclosed":"unopened";t=new l("".concat("start"===t?"Unclosed":"Unopened"," loop")),e=e.value;return t.properties={id:"".concat(o,"_loop"),explanation:'The loop with tag "'.concat(e,'" is ').concat(o),xtag:e,offset:r},n&&(t.properties.square=n),t},getDuplicateCloseTagException:function(e){var t=new l("Duplicate close tag, expected one close tag");return t.properties={xtag:a(e.xtag.split(" ")),id:"duplicate_close_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag ending with "'.concat(e.xtag.substr(0,10),'" has duplicate close tags')},t},getDuplicateOpenTagException:function(e){var t=new l("Duplicate open tag, expected one open tag");return t.properties={xtag:a(e.xtag.split(" ")),id:"duplicate_open_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" has duplicate open tags')},t},getCorruptCharactersException:function(e){var t=e.tag,r=e.value,n=(e=e.offset,new u("There are some XML corrupt characters"));return n.properties={id:"invalid_xml_characters",xtag:t,value:r,offset:e,explanation:"There are some corrupt characters for the field ".concat(t)},n},getInvalidRawXMLValueException:function(e){var t=e.tag,r=e.value,n=(e=e.offset,new u("Non string values are not allowed for rawXML tags"));return n.properties={id:"invalid_raw_xml_value",xtag:t,value:r,offset:e,explanation:"The value of the raw tag : '".concat(t,"' is not a string")},n},getUnbalancedLoopException:function(e,t){var r=new l("Unbalanced loop tag"),n=t[0].part.value,o=t[1].part.value,i=e[0].part.value,a=e[1].part.value;return r.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(n,"}{/").concat(o,"}{#").concat(i,"}{/").concat(a,"}"),offset:[t[0].part.offset,e[1].part.offset],lastPair:{left:t[0].part.value,right:t[1].part.value},pair:{left:e[0].part.value,right:e[1].part.value}},r},throwApiVersionError:function(e,t){throw(e=new f(e)).properties=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){var o,i;o=e,i=r[t=t],(t=function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(t))in o?Object.defineProperty(o,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[t]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:"api_version_error"},t),e},throwFileTypeNotHandled:function(e){var t=new p('The filetype "'.concat(e,'" is not handled by docxtemplater'));throw t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(e,'", but only docx and pptx formats are handled'),fileType:e},t},throwFileTypeNotIdentified:function(e){var t=0===(e=Object.keys(e.files).slice(0,10)).length?"Empty zip file":"Zip file contains : ".concat(e.join(","));throw(e=new p("The filetype for this file could not be identified, is this file corrupted ? ".concat(t))).properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ? ".concat(t)},e},throwMalformedXml:function(){var e=new p("Malformed xml");throw e.properties={explanation:"The template contains malformed xml",id:"malformed_xml"},e},throwMultiError:function(e){var t=new l("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t},throwExpandNotFound:function(e){var t=(r=e.part).value,r=r.offset,n=void 0===(n=e.id)?"raw_tag_outerxml_invalid":n,o=void 0===(o=e.message)?"Raw tag not in paragraph":o,i=e.part,a=e.explanation;throw"function"==typeof(a=void 0===a?'The tag "'.concat(t,'" is not inside a paragraph'):a)&&(a=a(i)),(i=new l(o)).properties={id:n,explanation:a,rootError:e.rootError,xtag:t,offset:r,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},i},throwRawTagShouldBeOnlyTextInParagraph:function(e){var t=new l("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(r,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:r,offset:e.part.offset,paragraphParts:e.paragraphParts},t},throwUnimplementedTagType:function(e,t){var r='Unimplemented tag type "'.concat(e.type,'"');throw e.module&&(r+=' "'.concat(e.module,'"')),(r=new l(r)).properties={part:e,index:t,id:"unimplemented_tag_type"},r},throwXmlTagNotFound:function(e){var t=new l('No tag "'.concat(e.element,'" was found at the ').concat(e.position)),r=e.parsed[e.index];throw t.properties={id:"no_xml_tag_found_at_".concat(e.position),explanation:'No tag "'.concat(e.element,'" was found at the ').concat(e.position),offset:r.offset,part:r,parsed:e.parsed,index:e.index,element:e.element},t},throwXmlInvalid:function(e,t){var r=new l("An XML file has invalid xml");throw r.properties={id:"file_has_invalid_xml",content:e,offset:t,explanation:"The docx contains invalid XML, it is most likely corrupt"},r},throwResolveBeforeCompile:function(){var e=new p("You must run `.compile()` before running `.resolveData()`");throw e.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"},e},throwRenderInvalidTemplate:function(){var e=new p("You should not call .render on a document that had compilation errors");throw e.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"},e},throwRenderTwice:function(){var e=new p("You should not call .render twice on the same docxtemplater instance");throw e.properties={id:"render_twice",explanation:"You should not call .render twice on the same docxtemplater instance"},e}}},cadb:function(e,t,r){e.exports=function(e,t,r){for(var n={},o=0,i=e.length;o<i;o++){var a=(s=e[o]).getAttribute("ContentType"),s=s.getAttribute("PartName").substr(1);n[s]=a}for(var l=0,u=t.length;l<u;l++)!function(){var e=t[l],o=e.getAttribute("ContentType"),i=e.getAttribute("Extension");r.file(/./).map((function(e){(e=e.name).slice(e.length-i.length)!==i||n[e]||"[Content_Types].xml"===e||(n[e]=o)}))}();return n}},ddee:function(e,t,r){var n={main:n=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml","application/vnd.ms-word.template.macroEnabledTemplate.main+xml"],docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"].concat(n,["application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml"]),pptx:["application/vnd.openxmlformats-officedocument.presentationml.slide+xml","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"]};e.exports=n},e192:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?i(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){var o,i;o=e,i=r[t=t],(t=function(e){return e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=n(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==n(e)?e:e+""}(t))in o?Object.defineProperty(o,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[t]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l,u=(l=r("c838")).getUnclosedTagException,c=l.getUnopenedTagException,p=l.getDuplicateOpenTagException,f=l.getDuplicateCloseTagException,h=l.throwMalformedXml,d=l.throwXmlInvalid,y=l.XTTemplateError,m=(l=r("5558")).isTextStart,g=l.isTextEnd,v=l.wordToUtf8;function b(e,t){for(var r=[],n=t.start,i=t.end,a=-1,s=!1;;){var l,u=e.indexOf(n,a+1),c=e.indexOf(i,a+1),p=null,f=void 0,h=(l=c,-1===(h=u)&&-1===l?0:h===l?1:-1===h||-1===l?l<h?2:3:h<l?2:3);switch(h=1===h?s?3:2:h){case 0:return r;case 3:s=!1,a=c,p="end",f=i.length;break;case 2:s=!0,a=u,p="start",f=n.length}2===h&&"="===e[a+n.length]?(r.push({offset:u,position:"start",length:n.length,changedelimiter:!0}),l=e.indexOf("=",a+n.length+1),h=e.indexOf(i,l+1),r.push({offset:h,position:"end",length:i.length,changedelimiter:!0}),l=function(e){if(2!==(e=e.split(" ")).length)throw(r=new y("New Delimiters cannot be parsed")).properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},r;e=(r=o(e,2))[0];var t,r=r[1];if(0===e.length||0===r.length)throw(t=new y("New Delimiters cannot be parsed")).properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},t;return[e,r]}(e.substr(a+n.length+1,l-a-n.length-1)),n=(l=o(l,2))[0],i=l[1],a=h):r.push({offset:a,position:p,length:f})}}function w(e,t,r){var n,o,i,a,l,h,d=e.map((function(e){return e.value})).join(""),y=(t=b(d,t),0),m=e.map((function(e){return{offset:(y+=e.value.length)-e.value.length,lIndex:e.lIndex}})),g=(t=(n=d,o=r,l=!(a=[]),h={offset:0},d=(d=t).reduce((function(e,t){var r=t.position,d=t.offset,y=h.offset,m=h.length;return i=n.substr(y,d-y),l&&"start"===r?(y+m===d?(i=n.substr(y,d-y+m+4),a.push(p({xtag:i,offset:y}))):a.push(u({xtag:v(i),offset:y})),h=t,e.push(s(s({},t),{},{error:!0}))):l||"end"!==r?(l=!l,h=t,e.push(t)):o.allowUnopenedTag||(y+m===d?(i=n.substr(y-4,d-y+m+4),a.push(f({xtag:i,offset:y}))):a.push(c({xtag:i,offset:d})),h=t,e.push(s(s({},t),{},{error:!0}))),e}),[]),l&&(r=h.offset,i=n.substr(r,n.length-r),a.push(u({xtag:v(i),offset:r}))),{delimiterWithErrors:d,errors:a})).delimiterWithErrors,w=(r=t.errors,0),x=0;return{parsed:m.map((function(t,r){for(var n,o,i=t.offset,a=[i,i+e[r].value.length],s=e[r].value,l=[];x<g.length&&(n=a,o=g[x],n[0]<=o.offset)&&o.offset<n[1];)l.push(g[x]),x++;var u=[],c=0;return 0<(t=(0<w&&(c=w,w=0),l.forEach((function(e){var t=s.substr(c,e.offset-i-c);e.changedelimiter?"start"===e.position?0<t.length&&u.push({type:"content",value:t}):c=e.offset-i+e.length:(0<t.length&&(u.push({type:"content",value:t}),c+=t.length),t={type:"delimiter",position:e.position,offset:c+i},u.push(t),c=e.offset-i+e.length)})),w=c-s.length,s.substr(c))).length&&u.push({type:"content",value:t}),u}),this),errors:r}}function x(e){return"content"===e.type&&"insidetag"===e.position}function T(e,t){var r=!1;e.forEach((function(e){var n,o;o=r,r=m(n=e)?(o&&h(),!0):g(n)?(o||h(),!1):o,"content"===e.type&&(e.position=r?"insidetag":"outsidetag"),"text"!==t&&x(e)&&(e.value=e.value.replace(/>/g,"&gt;"))}))}e.exports={parseDelimiters:w,parse:function(e,t,r,n){T(e,n);var o=(n=w(e.filter(x),t,r)).parsed,i=(t=n.errors,[]),a=0,s=0;return e.forEach((function(e){x(e)?(Array.prototype.push.apply(i,o[a].map((function(e){return"content"===e.type&&(e.position="insidetag"),e.lIndex=s++,e}))),a++):(e.lIndex=s++,i.push(e))})),{errors:t,lexed:i}},xmlparse:function(e,t){t=function(e,t,r){for(var n=0,o=e.length,i={},a=0,s=t.length;a<s;a++)i[t[a]]=!0;for(var l=0,u=r.length;l<u;l++)i[r[l]]=!1;for(var c,p=[];n<o&&-1!==(n=e.indexOf("<",n));){var f=n,h=e.indexOf("<",n+1),y=(g=m=c=void 0,c="",m=1,g=(y=h=((-1===(n=e.indexOf(">",n))||-1!==h&&h<n)&&d(e,f),e.slice(f,n+1))).indexOf(" "),"/"===y[y.length-2]?(c="selfclosing",-1===g&&(g=y.length-2)):(c="/"===y[1]?(m=2,"end"):"start",-1===g&&(g=y.length-1)),{tag:y.slice(m,g),position:c}),m=y.tag,g=i[m];null!=g&&p.push({type:"tag",position:y.position,text:g,offset:f,value:h,tag:m})}return p}(e,t.text,t.other);var r=0,n=(t=t.reduce((function(t,n){var o=e.substr(r,n.offset-r);return 0<o.length&&t.push({type:"content",value:o}),r=n.offset+n.value.length,delete n.offset,t.push(n),t}),[]),e.substr(r));return 0<n.length&&t.push({type:"content",value:n}),t}}},f261:function(e,t,r){e.exports=function(e,t){e.properties&&e.properties.errors instanceof Array&&e.properties.errors.map((function(e){return e.properties.explanation})).join("\n")}},f418:function(e,t,r){e.exports=function(e){for(var t=e.reduce((function(e,t){return e+t.length}),0),r=(e=e.filter((function(e){return 0<e.length})),new Array(t)),n=e.map((function(){return 0})),o=0;o<t;o++){var i=function(e,t){for(var r=-1,n=0,o=e.length;n<o;n++)t[n]>=e[n].length||(-1===r||e[n][t[n]].offset<e[r][t[r]].offset)&&(r=n);return r}(e,n);r[o]=e[i][n[i]],n[i]++}return r}},f9a2:function(e,t,r){e.exports=function(e,t){var r;return null==e.lIndex?null:(r=t.scopeManager.scopePathItem,e.parentPart&&(r=r.slice(0,r.length-1)),t.filePath+"@"+e.lIndex.toString()+"-"+r.join("-"))}},fbf9:function(e,t,r){var n=["modules"];function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};var r,n={};for(r in e)!Object.prototype.hasOwnProperty.call(e,r)||0<=t.indexOf(r)||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!=o(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"==o(e)?e:e+""}(n.key),n)}}var s,l=r("5558"),u=(l.traits=r("3c86"),l.moduleWrapper=r("50a1"),r("0dc8")),c=(s=r("c838")).throwMultiError,p=s.throwResolveBeforeCompile,f=s.throwRenderInvalidTemplate,h=s.throwRenderTwice,d=r("f261"),y=r("cadb"),m=r("c816"),g=r("e192"),v=l.defaults,b=l.str2xml,w=l.xml2str,x=l.moduleWrapper,T=l.concatArrays,P=l.uniq,O=l.getDuplicates,S=l.stableSort,E=(s=r("c838")).XTInternalError,j=s.throwFileTypeNotIdentified,k=s.throwFileTypeNotHandled,C=s.throwApiVersionError,I=[3,40,0];function A(e){e.modules=e.modules.filter((function(t){if(t.supportedFileTypes){var r;if(Array.isArray(t.supportedFileTypes))return(r=-1!==t.supportedFileTypes.indexOf(e.fileType))||t.on("detached"),r;throw new Error("The supportedFileTypes field of the module must be an array")}return!0}))}function M(e){var t=e.compiled;e.errors=T(Object.keys(t).map((function(e){return t[e].allErrors}))),0!==e.errors.length&&(e.options.errorLogging&&d(e.errors,e.options.errorLogging),c(e.errors))}(s=function(){function e(t){var r=this,o=void 0===(o=(a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).modules)?[]:o,a=i(a,n),s=this,l=e;if(!(s instanceof l))throw new TypeError("Cannot call a class as a function");if(!Array.isArray(o))throw new Error("The modules argument of docxtemplater's constructor must be an array");if(this.targets=[],this.rendered=!1,this.scopeManagers={},this.compiled={},this.modules=[m()],this.setOptions(a),o.forEach((function(e){r.attachModule(e)})),0<arguments.length){if(!t||!t.files||"function"!=typeof t.file)throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");this.loadZip(t),this.compile(),this.v4Constructor=!0}}return t=e,(r=[{key:"verifyApiVersion",value:function(e){return 3!==(e=e.split(".").map((function(e){return parseInt(e,10)}))).length&&C("neededVersion is not a valid version",{neededVersion:e,explanation:"the neededVersion must be an array of length 3"}),e[0]!==I[0]&&C("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:I,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(I.join("."))}),e[1]>I[1]&&C("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:I,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(I.join("."))}),e[1]===I[1]&&e[2]>I[2]&&C("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:I,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(I.join("."))}),!0}},{key:"setModules",value:function(e){this.modules.forEach((function(t){t.set(e)}))}},{key:"sendEvent",value:function(e){this.modules.forEach((function(t){t.on(e)}))}},{key:"attachModule",value:function(e){if(this.v4Constructor)throw new E("attachModule() should not be called manually when using the v4 constructor");var t=o(e);if("function"===t)throw new E("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.");if(!e||"object"!==t)throw new E("Cannot attachModule with a falsy value");if(e.requiredAPIVersion&&this.verifyApiVersion(e.requiredAPIVersion),!0===e.attached){if("function"!=typeof e.clone)throw new Error('Cannot attach a module that was already attached : "'.concat(e.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));e=e.clone()}return e.attached=!0,t=x(e),this.modules.push(t),t.on("attached"),this.fileType&&A(this),this}},{key:"setOptions",value:function(e){var t=this;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(e)return this.options={},Object.keys(v).forEach((function(r){var n=v[r];t.options[r]=null!=e[r]?e[r]:t[r]||n,t[r]=t.options[r]})),this.delimiters.start=l.utf8ToWord(this.delimiters.start),this.delimiters.end=l.utf8ToWord(this.delimiters.end),this;throw new Error("setOptions should be called with an object as first parameter")}},{key:"loadZip",value:function(e){if(this.v4Constructor)throw new Error("loadZip() should not be called manually when using the v4 constructor");if(e.loadAsync)throw new E("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");return this.zip=e,this.updateFileTypeConfig(),this.modules=T([this.fileTypeConfig.baseModules.map((function(e){return e()})),this.modules]),A(this),this}},{key:"precompileFile",value:function(e){var t=this.createTemplateClass(e);t.preparse(),this.compiled[e]=t}},{key:"compileFile",value:function(e){this.compiled[e].parse()}},{key:"getScopeManager",value:function(e,t,r){return this.scopeManagers[e]||(this.scopeManagers[e]=u({tags:r,parser:this.parser,cachedParsers:t.cachedParsers})),this.scopeManagers[e]}},{key:"resolveData",value:function(e){var t=this,r=[];return Object.keys(this.compiled).length||p(),Promise.resolve(e).then((function(e){return t.setData(e),t.setModules({data:t.data,Lexer:g}),t.mapper=t.modules.reduce((function(e,t){return t.getRenderedMap(e)}),{}),Promise.all(Object.keys(t.mapper).map((function(e){var n=(o=t.mapper[e]).from,o=o.data;return Promise.resolve(o).then((function(o){var i=t.compiled[n];return i.filePath=e,i.scopeManager=t.getScopeManager(e,i,o),i.resolveTags(o).then((function(e){return i.scopeManager.finishedResolving=!0,e}),(function(e){Array.prototype.push.apply(r,e)}))}))}))).then((function(e){return 0!==r.length&&(t.options.errorLogging&&d(r,t.options.errorLogging),c(r)),T(e)}))}))}},{key:"reorderModules",value:function(){this.modules=S(this.modules,(function(e,t){return(t.priority||0)-(e.priority||0)}))}},{key:"throwIfDuplicateModules",value:function(){var e=O(this.modules.map((function(e){return e.name})));if(0<e.length)throw new E('Detected duplicate module "'.concat(e[0],'"'))}},{key:"compile",value:function(){var e=this;return this.updateFileTypeConfig(),this.throwIfDuplicateModules(),this.reorderModules(),Object.keys(this.compiled).length||(this.options=this.modules.reduce((function(t,r){return r.optionsTransformer(t,e)}),this.options),this.options.xmlFileNames=P(this.options.xmlFileNames),this.xmlDocuments=this.options.xmlFileNames.reduce((function(t,r){var n=e.zip.files[r].asText();return t[r]=b(n),t}),{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.templatedFiles.forEach((function(t){null!=e.zip.files[t]&&e.precompileFile(t)})),this.templatedFiles.forEach((function(t){null!=e.zip.files[t]&&e.compileFile(t)})),this.setModules({compiled:this.compiled}),M(this)),this}},{key:"getRelsTypes",value:function(){for(var e,t=(e=(e=this.zip.files["_rels/.rels"])?b(e.asText()):null)?e.getElementsByTagName("Relationship"):[],r={},n=0,o=t.length;n<o;n++){var i=t[n];r[i.getAttribute("Target")]=i.getAttribute("Type")}return r}},{key:"getContentTypes",value:function(){var e=this.zip.files["[Content_Types].xml"],t=e?b(e.asText()):null;return{overrides:t?t.getElementsByTagName("Override"):null,defaults:t?t.getElementsByTagName("Default"):null,contentTypes:e,contentTypeXml:t}}},{key:"updateFileTypeConfig",value:function(){var t,r=this,n=(this.zip.files.mimetype&&(t="odt"),this.relsTypes=this.getRelsTypes(),this.getContentTypes()),o=n.overrides,i=n.defaults,a=n.contentTypes,s=n.contentTypeXml;return s&&(this.filesContentTypes=y(o,i,this.zip),this.invertedContentTypes=l.invertMap(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes})),this.modules.forEach((function(e){t=e.getFileType({zip:r.zip,contentTypes:a,contentTypeXml:s,overrides:o,defaults:i,doc:r})||t})),"odt"===t&&k(t),t||j(this.zip),this.fileType=t,A(this),this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig||e.FileTypeConfig[this.fileType](),this}},{key:"renderAsync",value:function(e){var t=this;return this.resolveData(e).then((function(){return t.render()}))}},{key:"render",value:function(e){var t=this;return this.rendered&&h(),this.rendered=!0,this.compile(),0<this.errors.length&&f(),e&&this.setData(e),this.setModules({data:this.data,Lexer:g}),this.mapper=this.mapper||this.modules.reduce((function(e,t){return t.getRenderedMap(e)}),{}),Object.keys(this.mapper).forEach((function(e){var r=(n=t.mapper[e]).from,n=n.data;(r=t.compiled[r]).scopeManager=t.getScopeManager(e,r,n),r.render(e),t.zip.file(e,r.content,{createFolders:!0})})),M(this),this.sendEvent("syncing-zip"),this.syncZip(),this.sendEvent("synced-zip"),this}},{key:"syncZip",value:function(){var e=this;Object.keys(this.xmlDocuments).forEach((function(t){e.zip.remove(t);var r=w(e.xmlDocuments[t]);return e.zip.file(t,r,{createFolders:!0})}))}},{key:"setData",value:function(e){return this.data=e,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:"createTemplateClassFromContent",value:function(t,r){var n=this,o={filePath:r,contentType:this.filesContentTypes[r],relsType:this.relsTypes[r]};return Object.keys(v).concat(["filesContentTypes","fileTypeConfig","fileType","modules"]).forEach((function(e){o[e]=n[e]})),new e.XmlTemplater(t,o)}},{key:"getFullText",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){var e=this;return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.targets.forEach((function(t){e.templatedFiles.push(t)})),this.templatedFiles=P(this.templatedFiles),this.templatedFiles}}])&&a(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}()).DocUtils=l,s.Errors=r("c838"),s.XmlTemplater=r("8a20"),s.FileTypeConfig=r("5114"),s.XmlMatcher=r("4072"),e.exports=s,e.exports.default=s}}]);